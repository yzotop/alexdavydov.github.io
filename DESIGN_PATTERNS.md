# DESIGN_PATTERNS.md
Версия: 0.1  
Связанный документ: STYLE_GUIDE_CURSOR.md

Цель: описать устойчивые паттерны интерактивных страниц (калькуляторов, сравнений, воронок), чтобы новые страницы выглядели и читались одинаково.

---

## 1. Общий паттерн страницы-калькулятора

Страница всегда состоит из двух колонок:

### Левая колонка — управление
- Ползунки / инпуты
- У каждого параметра:
  - текущее значение
  - базовое значение (подпись `база:`)
- Порядок параметров повторяет реальный порядок системы

### Правая колонка — результат
Всегда сверху вниз:
1. Главная метрика (крупно)
2. Δ к базе (₽ и %)
3. Короткая текстовая интерпретация
4. Графики / разбор влияния
5. Детали расчёта (сворачиваемые)

---

## 2. Паттерн «Главная метрика»

Обязательно:
- Крупное число (выручка / индекс / эффект)
- Подпись единиц измерения
- Рядом или ниже — Δ к базе

Цвет:
- Зелёный — рост
- Красный — падение
- Серый — около нуля

---

## 3. Паттерн «Текст-интерпретация»

Под главным числом всегда 1–2 строки:

Формат:
> Что происходит → почему → на что смотреть

Примеры:
- «Рост CPM перекрывает падение Fill rate»
- «Падение Show rate даёт мультипликативный минус»
- «Основной эффект формируется на последнем шаге воронки»

Без воды, без терминов «в среднем», «может быть», «вероятно».

---

## 4. Паттерн «Сколько стоит +1 шаг»

Используется для ответа на вопрос:
> Где сейчас самый выгодный рычаг?

Формат:
- Таблица или bar-chart
- Строка = один шаг системы
- Показывается:
  - базовое значение
  - эффект +1 шага
  - эффект в % и в ₽

Обязательно:
- Выделение **лучшего рычага**
- Короткое пояснение ПОЧЕМУ он лучший

---

## 5. Паттерн «Контроль vs тест»

Используется для разложения итогового эффекта.

Формат:
- Один столбец = вклад шага в ₽
- Зелёный — положительный вклад
- Красный — отрицательный вклад
- Внизу строка **Итого**

Обязательно:
- Фраза-инсайт над графиком
  Пример:
  > «Рост CPM перекрыл потери на Fill / Show rate»

---

## 6. Паттерн «Сравнение сценариев»

Для A/B/C или нескольких тестов:
- На прод уходит **один вариант**
- Все варианты считаются как проекция на 100%

График:
- Общая точка старта (0%)
- Текущая доля
- 100% раскатка
- Подписи A / B / C прямо на линиях

Текст:
- Явный выбор лучшего варианта
- Предупреждение о рисках (если есть)

---

## 7. Паттерн «Детали расчёта»

Всегда скрыты по умолчанию.

Показывают:
- формулу
- промежуточные коэффициенты
- текущие значения

Цель — проверяемость, не обучение.

---

## 8. Что НЕ делать

Запрещено:
- декоративные графики без смысла
- легенды вместо подписей
- одинаковые цвета для разных смыслов
- «умные» выводы без расчёта
- больше 2 графиков без текста

---

## 9. Done-definition для страницы

Страница считается готовой, если:
- ответ считывается за 1 секунду
- видно «где болит»
- видно «что чинить»
- видно «почему именно это»

---

## 10. Связь с Cursor

Любая генерация новых страниц должна начинаться с:
> Делай строго по STYLE_GUIDE_CURSOR.md и DESIGN_PATTERNS.md

---

## Term links (Glossary references)

### Цель
Термины и метрики в проекте используются как **точки углубления**, а не как визуальные маркеры.
Основной текст должен читаться линейно, без постоянных отвлекающих акцентов.

### Правило отображения
- Термины в тексте (например: CPM, Revenue, Fill rate) оформляются как обычные текстовые ссылки
- **Без постоянной заливки, бейджей или иконок**
- Визуальная подсветка (плашка, фон, рамка) появляется **только при hover или focus**
- В обычном состоянии термин не отличается от других ссылок по плотности внимания

### Причина
- Постоянная подсветка терминов ухудшает читаемость длинных аналитических текстов
- Термины не должны конкурировать с аргументом и выводами
- Пользователь сам решает, когда углубляться в определение

### UX-паттерн
Используется принцип *progressive disclosure*:
> сложность раскрывается только по запросу пользователя

### Техническая реализация
- Все ссылки на термины используют класс `.term-link`
- Hover-стили определены централизованно в `lab/assets/css/links.css`
- Определения хранятся в едином источнике — HTML-глоссарии (`/lab/glossary/`)
- Определения **не дублируются** в контенте страниц

### Запрещено
- Делать термины визуально заметными без hover
- Вставлять определения прямо в текст страниц
- Использовать разные стили терминов на разных страницах

---

