<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Симулятор Ride-Hailing — Alex Davydov</title>
    <link rel="stylesheet" href="assets/app.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="breadcrumb">
                <a href="/">Главная</a>
                <span>→</span>
                <a href="/calculators/">Калькуляторы</a>
                <span>→</span>
                <span>Симулятор Ride-Hailing</span>
            </div>
            <h1>Симулятор Ride-Hailing</h1>
            <p class="subtitle">Двусторонний рынок: спрос, предложение, SLA и деньги во времени.</p>
        </header>

        <div class="page-layout">
            <div id="controls" class="controls left-panel">
                <div class="card">
                    <h2>Параметры</h2>

                    <div class="form-field">
                        <label for="scenario">Сценарий</label>
                        <select id="scenario">
                            <option value="baseline">Baseline</option>
                            <option value="rain_peak">Rain peak</option>
                            <option value="driver_strike">Driver strike</option>
                        </select>
                        <div class="error"></div>
                    </div>

                    <div class="actions">
                        <button id="resetBtn">Сбросить параметры</button>
                        <div class="actions-secondary">
                            <button id="exportBtn" class="secondary">Экспорт CSV</button>
                        </div>
                    </div>

                    <div class="param-section">
                        <h3>Базовые параметры</h3>

                        <div class="form-field">
                            <label for="base_demand_requests">Базовый спрос (заявки в неделю)</label>
                            <input type="number" id="base_demand_requests" min="2000" max="30000" step="500" value="10000">
                            <div class="error"></div>
                        </div>

                        <div class="form-field">
                            <label for="avg_price">Средний чек (₽)</label>
                            <input type="number" id="avg_price" min="200" max="1200" step="50" value="500">
                            <div class="hint">Средняя стоимость поездки для пассажира</div>
                            <div class="error"></div>
                        </div>

                        <div class="form-field">
                            <label for="price_elasticity">Эластичность по цене</label>
                            <input type="number" id="price_elasticity" min="0.3" max="2.5" step="0.1" value="1.1">
                            <div class="error"></div>
                        </div>

                        <div class="form-field">
                            <label for="eta_elasticity">Эластичность по ETA (SLA)</label>
                            <input type="number" id="eta_elasticity" min="0.5" max="3.0" step="0.1" value="1.3">
                            <div class="hint">Чувствительность спроса к времени ожидания</div>
                            <div class="error"></div>
                        </div>

                        <div class="form-field">
                            <label for="active_drivers_start">Активные водители (старт)</label>
                            <input type="number" id="active_drivers_start" min="100" max="1200" step="50" value="400">
                            <div class="error"></div>
                        </div>

                        <div class="form-field">
                            <label for="onboard_per_week">Онбординг в неделю (водителей)</label>
                            <input type="number" id="onboard_per_week" min="0" max="40" step="2" value="8">
                            <div class="error"></div>
                        </div>

                        <div class="form-field">
                            <label for="base_churn_rate">Churn водителей (нед.)</label>
                            <input type="number" id="base_churn_rate" min="0" max="0.1" step="0.005" value="0.015">
                            <div class="hint">Доля водителей, уходящих за неделю</div>
                            <div class="error"></div>
                        </div>

                        <div class="form-field">
                            <label for="take_rate">Комиссия платформы (%)</label>
                            <input type="number" id="take_rate" min="5" max="40" step="1" value="22">
                            <div class="error"></div>
                        </div>
                    </div>

                    <div class="param-section param-section-advanced">
                        <details class="advanced-details">
                            <summary class="advanced-summary">
                                <h3>Расширенные параметры</h3>
                            </summary>
                            <div class="advanced-content">

                                <div class="form-field">
                                    <label for="trips_per_driver_per_week">Поездок на водителя в неделю</label>
                                    <input type="number" id="trips_per_driver_per_week" min="10" max="50" step="5" value="25">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="driver_bonus_per_trip">Стоимость на поездку (₽)</label>
                                    <input type="number" id="driver_bonus_per_trip" min="0" max="400" step="10" value="50">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="churn_over_k">Чувствительность churn к перегрузке</label>
                                    <input type="number" id="churn_over_k" min="0" max="0.5" step="0.02" value="0.12">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="target_util">Целевая загрузка (target_util)</label>
                                    <input type="number" id="target_util" min="0.5" max="0.9" step="0.02" value="0.7">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="base_eta">ETA (база, минут)</label>
                                    <input type="number" id="base_eta" min="3" max="15" step="1" value="6">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="eta_k">Сила роста ETA при перегрузе (eta_k)</label>
                                    <input type="number" id="eta_k" min="1" max="5" step="0.2" value="3">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="eta_pow">Нелинейность роста ETA (eta_pow)</label>
                                    <input type="number" id="eta_pow" min="2" max="4" step="0.1" value="2.5">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="sla_penalty_per_unfulfilled">Штраф/потери за невыполненную заявку (₽)</label>
                                    <input type="number" id="sla_penalty_per_unfulfilled" min="0" max="500" step="10" value="30">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="onboard_cost_per_driver">Стоимость онбординга водителя (₽)</label>
                                    <input type="number" id="onboard_cost_per_driver" min="0" max="10000" step="100" value="2000">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="season_amp">Сезонность (амплитуда)</label>
                                    <input type="number" id="season_amp" min="0" max="0.3" step="0.05" value="0.15">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="noise_level">Уровень шума</label>
                                    <input type="number" id="noise_level" min="0" max="0.25" step="0.01" value="0.07">
                                    <div class="error"></div>
                                </div>

                                <div class="form-field">
                                    <label for="random_seed">Seed (1..999)</label>
                                    <input type="number" id="random_seed" min="1" max="999" step="1" value="42">
                                    <div class="error"></div>
                                </div>

                            </div>
                        </details>
                    </div>
                </div>
            </div>

            <div id="results" class="results">
                <div id="statusBar" class="statusbar" aria-live="polite">Инициализация…</div>
                <div class="status-indicator" id="statusIndicator"></div>

                <div id="kpiTiles" class="kpi-tiles"></div>

                <div class="charts-grid">
                    <div class="card chart-card">
                        <h2>Спрос: запросы vs выполненные vs невыполненные</h2>
                        <div class="chart-legend" id="legend-demand"></div>
                        <div class="chart-area tall">
                            <canvas id="chartDemand"></canvas>
                        </div>
                    </div>

                    <div class="card chart-card">
                        <h2>Водители и ёмкость (поездок в неделю)</h2>
                        <div class="chart-legend" id="legend-supply"></div>
                        <div class="chart-area">
                            <canvas id="chartSupply"></canvas>
                        </div>
                    </div>

                    <div class="card chart-card">
                        <h2>Utilization и match rate</h2>
                        <div class="chart-legend" id="legend-util"></div>
                        <div class="chart-area">
                            <canvas id="chartUtilMatch"></canvas>
                        </div>
                    </div>

                    <div class="card chart-card">
                        <h2>ETA (минуты)</h2>
                        <div class="chart-legend" id="legend-eta"></div>
                        <div class="chart-area">
                            <canvas id="chartETA"></canvas>
                        </div>
                    </div>

                    <div class="card chart-card">
                        <h2>Выручка нетто по неделям</h2>
                        <div class="chart-legend" id="legend-net"></div>
                        <div class="chart-area">
                            <canvas id="chartNetRevenue"></canvas>
                        </div>
                    </div>

                    <div class="card chart-card">
                        <h2>GMV по неделям</h2>
                        <div class="chart-legend" id="legend-gmv"></div>
                        <div class="chart-area">
                            <canvas id="chartGMV"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/charts.js"></script>
    <script src="assets/app.js"></script>
</body>
</html>

