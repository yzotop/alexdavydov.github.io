# Симулятор — Классификатор метрик

**Файл:** `simulators/metric_classifier/index.html`

## Как использовать

1. Откройте симулятор в браузере.
2. Выберите пресет из выпадающего списка (12 готовых примеров) — поля заполнятся автоматически.
3. Нажмите **«Классифицировать»**.
4. Изучите результат: тип метрики, рекомендованный подход, предупреждения.
5. Попробуйте изменить параметры вручную и переклассифицировать — посмотрите, как меняется результат.

## На что обратить внимание

- **Долей vs Ratio**: CTR (клики/показы) и refund rate (возвраты/заказы) — это доли, а не ratio: числитель подсчитывает бинарные события знаменателя. AOV (GMV/заказы) и RPM (выручка/показы) — это ratio: числитель — непрерывная величина другой природы.
- Переключение между `per-user mean` и `global ratio` при одинаковых числителе и знаменателе меняет тип метрики и рекомендованный тест.
- Включение галочки «есть условие» мгновенно переводит метрику в Conditional — появляется предупреждение о selection bias.
- Метрики с revenue/GMV в числителе получают предупреждение о heavy tail — даже если тип метрики простой (per-user).
- Для метрик долей с нестандартной единицей анализа (показ, заказ) появляется предупреждение о treatment-affected exposure.

## Если ошиблись в классификации — что ломается

1. **Ratio → t-test**: дисперсия отношения занижена, p-value завышен, ложные срабатывания растут. Эффект может «появляться» и «исчезать» при повторных запусках.
2. **Долей → ratio-подход**: не критично (delta-method работает), но избыточно — z-test проще и точнее для биномиальных данных.
3. **Conditional → наивное сравнение**: selection bias делает оценку эффекта смещённой. Вы сравниваете разные популяции и интерпретируете разницу как каузальный эффект.
4. **Heavy tail + t-test**: один пользователь с аномальной выручкой двигает среднее всей группы. Результат теста нестабилен и не воспроизводится.
