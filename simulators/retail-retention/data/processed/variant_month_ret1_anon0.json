{
  "meta": {
    "dataset": "Online Retail II (UCI)",
    "generated_at": "2026-01-30T05:27:42Z",
    "variant": {
      "granularity": "month",
      "include_returns": true,
      "include_anon": false
    },
    "raw_rows": 1067371,
    "rows_after_filters": 824364,
    "date_min": "2009-12-01",
    "date_max": "2011-12-09",
    "max_offsets": 12,
    "definitions": {
      "returns": "Invoice startswith 'C' OR Quantity < 0 treated as returns/cancellations",
      "retention": "share of cohort customers with >=1 order in offset period (with positive net revenue)"
    }
  },
  "sanity": {
    "checks": [
      {
        "key": "total_rows",
        "label": "Total rows",
        "value": "1,067,371",
        "ok": true
      },
      {
        "key": "rows_after_filters",
        "label": "Rows after filters",
        "value": "824,364",
        "ok": true
      },
      {
        "key": "missing_customerid",
        "label": "Missing CustomerID",
        "value": "243,007 (22.77%)",
        "ok": true
      },
      {
        "key": "qty_le_0",
        "label": "Quantity ≤ 0",
        "value": "22,950 (2.15%)",
        "ok": true
      },
      {
        "key": "unitprice_le_0",
        "label": "UnitPrice ≤ 0",
        "value": "6,207 (0.58%)",
        "ok": true
      },
      {
        "key": "cancellations",
        "label": "Cancellations (Invoice starts with C)",
        "value": "19,494 (1.83%)",
        "ok": true
      },
      {
        "key": "duplicates",
        "label": "Duplicate rows (row key)",
        "value": "34,339 (3.22%)",
        "ok": true
      },
      {
        "key": "date_range",
        "label": "InvoiceDate range",
        "value": "2009-12-01 → 2011-12-09",
        "ok": true
      },
      {
        "key": "top_countries",
        "label": "Top 5 countries by revenue (net)",
        "value": "United Kingdom (13,806,423.03), EIRE (578,501.63), Netherlands (548,524.95), Germany (417,988.56), France (326,504.67)",
        "ok": true
      },
      {
        "key": "p99_invoice_value",
        "label": "p99 invoice value (positive invoices)",
        "value": "3,697.92",
        "ok": true
      }
    ],
    "top_countries": [
      {
        "country": "United Kingdom",
        "revenue": 13806423.03
      },
      {
        "country": "EIRE",
        "revenue": 578501.63
      },
      {
        "country": "Netherlands",
        "revenue": 548524.95
      },
      {
        "country": "Germany",
        "revenue": 417988.56
      },
      {
        "country": "France",
        "revenue": 326504.67
      }
    ]
  },
  "cohort_matrix": {
    "cohorts": [
      "2009-12",
      "2010-01",
      "2010-02",
      "2010-03",
      "2010-04",
      "2010-05",
      "2010-06",
      "2010-07",
      "2010-08",
      "2010-09",
      "2010-10",
      "2010-11",
      "2010-12",
      "2011-01",
      "2011-02",
      "2011-03",
      "2011-04",
      "2011-05",
      "2011-06",
      "2011-07",
      "2011-08",
      "2011-09",
      "2011-10",
      "2011-11",
      "2011-12"
    ],
    "offsets": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "values": [
      [
        98.3,
        34.5,
        32.8,
        41.8,
        37.4,
        35.4,
        37.1,
        33.9,
        33.1,
        35.6,
        41.4,
        48.7,
        37.1
      ],
      [
        96.7,
        19.3,
        29.6,
        29.1,
        25.6,
        28.6,
        24.6,
        22.6,
        27.1,
        31.2,
        28.9,
        16.3,
        21.4
      ],
      [
        99.5,
        23.7,
        22.7,
        28.8,
        24.3,
        19.5,
        19.2,
        28.5,
        25.3,
        27.7,
        11.7,
        12.3,
        14.9
      ],
      [
        97.1,
        18.3,
        22.3,
        23.4,
        22.3,
        19.6,
        23.4,
        29.8,
        27.2,
        10.6,
        11.0,
        14.1,
        19.2
      ],
      [
        97.3,
        18.0,
        19.0,
        15.7,
        17.7,
        22.3,
        27.0,
        24.7,
        10.7,
        10.3,
        7.3,
        13.7,
        13.3
      ],
      [
        99.2,
        15.3,
        16.5,
        17.6,
        17.6,
        25.5,
        21.6,
        12.5,
        6.3,
        8.2,
        11.4,
        13.7,
        15.3
      ],
      [
        97.1,
        16.7,
        18.5,
        19.9,
        22.1,
        27.9,
        12.3,
        8.7,
        8.0,
        11.6,
        10.1,
        13.4,
        14.5
      ],
      [
        100.0,
        15.4,
        18.1,
        29.3,
        28.7,
        13.3,
        11.2,
        14.9,
        14.4,
        11.2,
        13.3,
        14.4,
        13.3
      ],
      [
        100.0,
        19.4,
        30.0,
        31.9,
        16.9,
        11.9,
        10.0,
        12.5,
        13.8,
        12.5,
        13.1,
        12.5,
        15.6
      ],
      [
        97.6,
        22.4,
        22.9,
        12.2,
        8.6,
        10.2,
        13.5,
        9.4,
        12.7,
        12.7,
        11.0,
        9.4,
        22.0
      ],
      [
        98.2,
        25.1,
        14.4,
        12.0,
        8.6,
        8.6,
        13.1,
        13.1,
        10.7,
        9.4,
        10.5,
        13.1,
        19.4
      ],
      [
        99.1,
        17.3,
        9.4,
        9.4,
        7.6,
        8.8,
        13.4,
        10.0,
        8.8,
        9.7,
        11.2,
        14.9,
        25.5
      ],
      [
        98.7,
        9.1,
        5.2,
        7.8,
        11.7,
        6.5,
        5.2,
        9.1,
        5.2,
        2.6,
        9.1,
        19.5,
        2.6
      ],
      [
        100.0,
        15.1,
        21.9,
        17.8,
        21.9,
        13.7,
        15.1,
        12.3,
        11.0,
        20.5,
        24.7,
        11.0,
        0.0
      ],
      [
        100.0,
        15.3,
        15.3,
        18.5,
        21.8,
        15.3,
        15.3,
        14.5,
        14.5,
        17.7,
        5.6,
        0.0,
        0.0
      ],
      [
        100.0,
        17.9,
        21.8,
        20.1,
        22.3,
        14.5,
        20.7,
        20.1,
        24.0,
        9.5,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        24.5,
        19.8,
        19.8,
        17.9,
        23.6,
        17.9,
        25.5,
        11.3,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        23.2,
        24.1,
        16.1,
        21.4,
        20.5,
        25.9,
        10.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        22.2,
        21.3,
        26.9,
        20.4,
        28.7,
        8.3,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        99.0,
        20.6,
        30.4,
        27.5,
        34.3,
        15.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        27.1,
        30.8,
        26.2,
        16.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        26.5,
        37.6,
        14.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        99.1,
        32.0,
        15.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        99.0,
        14.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        96.4,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    ]
  },
  "revenue_matrix": {
    "cohorts": [
      "2009-12",
      "2010-01",
      "2010-02",
      "2010-03",
      "2010-04",
      "2010-05",
      "2010-06",
      "2010-07",
      "2010-08",
      "2010-09",
      "2010-10",
      "2010-11",
      "2010-12",
      "2011-01",
      "2011-02",
      "2011-03",
      "2011-04",
      "2011-05",
      "2011-06",
      "2011-07",
      "2011-08",
      "2011-09",
      "2011-10",
      "2011-11",
      "2011-12"
    ],
    "offsets": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "values": [
      [
        99.9,
        55.3,
        42.4,
        55.4,
        43.6,
        41.4,
        44.0,
        44.7,
        46.7,
        54.4,
        62.6,
        82.2,
        77.3
      ],
      [
        99.7,
        23.7,
        31.4,
        34.5,
        35.1,
        36.8,
        31.1,
        35.9,
        29.2,
        45.8,
        46.6,
        36.6,
        25.1
      ],
      [
        100.0,
        19.8,
        32.3,
        31.0,
        25.2,
        23.3,
        22.4,
        30.5,
        31.4,
        32.9,
        21.8,
        11.3,
        16.5
      ],
      [
        87.7,
        23.5,
        22.6,
        26.0,
        23.5,
        25.6,
        30.5,
        39.0,
        36.4,
        16.1,
        11.5,
        14.1,
        20.7
      ],
      [
        88.7,
        14.0,
        16.4,
        19.1,
        17.6,
        25.0,
        28.3,
        25.2,
        12.8,
        13.9,
        5.0,
        13.7,
        12.1
      ],
      [
        100.0,
        11.9,
        12.7,
        11.9,
        15.0,
        28.2,
        21.4,
        12.0,
        4.4,
        6.4,
        8.4,
        12.1,
        15.9
      ],
      [
        70.2,
        9.6,
        17.9,
        20.4,
        27.8,
        38.3,
        19.5,
        13.7,
        19.1,
        22.6,
        9.2,
        23.9,
        32.2
      ],
      [
        100.0,
        10.1,
        17.9,
        32.6,
        37.7,
        20.7,
        11.8,
        14.1,
        13.3,
        13.2,
        11.9,
        16.5,
        16.2
      ],
      [
        100.0,
        20.8,
        37.9,
        34.4,
        24.4,
        8.5,
        8.8,
        11.9,
        16.1,
        15.9,
        12.0,
        11.6,
        18.3
      ],
      [
        99.9,
        12.6,
        20.5,
        17.2,
        16.2,
        4.6,
        16.5,
        6.6,
        18.7,
        8.8,
        12.5,
        16.3,
        63.2
      ],
      [
        97.5,
        23.4,
        15.0,
        13.7,
        7.7,
        6.7,
        10.1,
        9.0,
        12.6,
        11.5,
        8.0,
        12.2,
        27.6
      ],
      [
        100.0,
        23.1,
        9.5,
        6.2,
        5.7,
        7.1,
        10.4,
        7.6,
        6.4,
        7.9,
        9.8,
        13.3,
        27.1
      ],
      [
        100.0,
        5.0,
        17.5,
        3.5,
        15.0,
        2.7,
        1.7,
        12.1,
        1.4,
        1.0,
        4.1,
        21.5,
        0.9
      ],
      [
        100.0,
        6.8,
        8.2,
        6.5,
        16.0,
        12.2,
        9.5,
        10.9,
        8.4,
        22.3,
        20.5,
        7.1,
        0.0
      ],
      [
        100.0,
        19.4,
        37.7,
        24.7,
        21.2,
        12.7,
        18.3,
        22.6,
        21.9,
        28.2,
        6.3,
        0.0,
        0.0
      ],
      [
        100.0,
        17.9,
        25.9,
        20.8,
        21.0,
        13.7,
        20.0,
        23.4,
        27.7,
        8.3,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        32.0,
        18.6,
        17.8,
        13.8,
        27.4,
        15.0,
        27.9,
        9.6,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        19.4,
        21.8,
        13.0,
        22.0,
        22.0,
        29.4,
        8.6,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        21.5,
        17.6,
        23.2,
        20.8,
        30.1,
        5.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        99.0,
        17.3,
        26.4,
        28.0,
        34.5,
        10.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        38.4,
        64.7,
        81.4,
        28.6,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        18.7,
        31.6,
        10.6,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        34.0,
        11.1,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        15.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    ]
  },
  "segments": [
    {
      "segment": "Champions",
      "customers": 1368,
      "repeaters": 1368,
      "orders": 27901,
      "revenue": 11735413.89,
      "aov": 420.61,
      "repeat_rate": 100.0
    },
    {
      "segment": "Loyal",
      "customers": 660,
      "repeaters": 660,
      "orders": 7185,
      "revenue": 2214150.52,
      "aov": 308.16,
      "repeat_rate": 100.0
    },
    {
      "segment": "Potential Loyalist",
      "customers": 808,
      "repeaters": 808,
      "orders": 2728,
      "revenue": 810277.1,
      "aov": 297.02,
      "repeat_rate": 100.0
    },
    {
      "segment": "At Risk",
      "customers": 380,
      "repeaters": 380,
      "orders": 2140,
      "revenue": 558212.84,
      "aov": 260.85,
      "repeat_rate": 100.0
    },
    {
      "segment": "Need Attention",
      "customers": 511,
      "repeaters": 511,
      "orders": 1683,
      "revenue": 492511.58,
      "aov": 292.64,
      "repeat_rate": 100.0
    },
    {
      "segment": "About To Sleep",
      "customers": 787,
      "repeaters": 402,
      "orders": 1353,
      "revenue": 376418.98,
      "aov": 278.21,
      "repeat_rate": 51.1
    },
    {
      "segment": "Lost",
      "customers": 997,
      "repeaters": 352,
      "orders": 1455,
      "revenue": 308783.38,
      "aov": 212.22,
      "repeat_rate": 35.3
    },
    {
      "segment": "Others",
      "customers": 210,
      "repeaters": 0,
      "orders": 210,
      "revenue": 80845.06,
      "aov": 384.98,
      "repeat_rate": 0.0
    },
    {
      "segment": "Promising",
      "customers": 153,
      "repeaters": 0,
      "orders": 153,
      "revenue": 48668.32,
      "aov": 318.09,
      "repeat_rate": 0.0
    },
    {
      "segment": "New Customers",
      "customers": 68,
      "repeaters": 0,
      "orders": 68,
      "revenue": 23010.72,
      "aov": 338.39,
      "repeat_rate": 0.0
    }
  ],
  "segment_bars": [
    {
      "label": "Champions",
      "value": 11735413.89
    },
    {
      "label": "Loyal",
      "value": 2214150.52
    },
    {
      "label": "Potential Loyalist",
      "value": 810277.1
    },
    {
      "label": "At Risk",
      "value": 558212.84
    },
    {
      "label": "Need Attention",
      "value": 492511.58
    },
    {
      "label": "About To Sleep",
      "value": 376418.98
    },
    {
      "label": "Lost",
      "value": 308783.38
    },
    {
      "label": "Others",
      "value": 80845.06
    },
    {
      "label": "Promising",
      "value": 48668.32
    },
    {
      "label": "New Customers",
      "value": 23010.72
    }
  ]
}