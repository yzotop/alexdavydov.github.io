{
  "meta": {
    "dataset": "Online Retail II (UCI)",
    "generated_at": "2026-01-30T05:27:42Z",
    "variant": {
      "granularity": "month",
      "include_returns": false,
      "include_anon": false
    },
    "raw_rows": 1067371,
    "rows_after_filters": 805620,
    "date_min": "2009-12-01",
    "date_max": "2011-12-09",
    "max_offsets": 12,
    "definitions": {
      "returns": "Invoice startswith 'C' OR Quantity < 0 treated as returns/cancellations",
      "retention": "share of cohort customers with >=1 order in offset period (with positive net revenue)"
    }
  },
  "sanity": {
    "checks": [
      {
        "key": "total_rows",
        "label": "Total rows",
        "value": "1,067,371",
        "ok": true
      },
      {
        "key": "rows_after_filters",
        "label": "Rows after filters",
        "value": "805,620",
        "ok": true
      },
      {
        "key": "missing_customerid",
        "label": "Missing CustomerID",
        "value": "243,007 (22.77%)",
        "ok": true
      },
      {
        "key": "qty_le_0",
        "label": "Quantity ≤ 0",
        "value": "22,950 (2.15%)",
        "ok": true
      },
      {
        "key": "unitprice_le_0",
        "label": "UnitPrice ≤ 0",
        "value": "6,207 (0.58%)",
        "ok": true
      },
      {
        "key": "cancellations",
        "label": "Cancellations (Invoice starts with C)",
        "value": "19,494 (1.83%)",
        "ok": true
      },
      {
        "key": "duplicates",
        "label": "Duplicate rows (row key)",
        "value": "34,339 (3.22%)",
        "ok": true
      },
      {
        "key": "date_range",
        "label": "InvoiceDate range",
        "value": "2009-12-01 → 2011-12-09",
        "ok": true
      },
      {
        "key": "top_countries",
        "label": "Top 5 countries by revenue (net)",
        "value": "United Kingdom (14,723,147.52), EIRE (621,631.11), Netherlands (554,232.34), Germany (431,262.46), France (355,257.47)",
        "ok": true
      },
      {
        "key": "p99_invoice_value",
        "label": "p99 invoice value (positive invoices)",
        "value": "3,697.92",
        "ok": true
      }
    ],
    "top_countries": [
      {
        "country": "United Kingdom",
        "revenue": 14723147.52
      },
      {
        "country": "EIRE",
        "revenue": 621631.11
      },
      {
        "country": "Netherlands",
        "revenue": 554232.34
      },
      {
        "country": "Germany",
        "revenue": 431262.46
      },
      {
        "country": "France",
        "revenue": 355257.47
      }
    ]
  },
  "cohort_matrix": {
    "cohorts": [
      "2009-12",
      "2010-01",
      "2010-02",
      "2010-03",
      "2010-04",
      "2010-05",
      "2010-06",
      "2010-07",
      "2010-08",
      "2010-09",
      "2010-10",
      "2010-11",
      "2010-12",
      "2011-01",
      "2011-02",
      "2011-03",
      "2011-04",
      "2011-05",
      "2011-06",
      "2011-07",
      "2011-08",
      "2011-09",
      "2011-10",
      "2011-11",
      "2011-12"
    ],
    "offsets": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "values": [
      [
        100.0,
        35.3,
        33.4,
        42.5,
        38.0,
        35.9,
        37.7,
        34.2,
        33.6,
        36.2,
        42.2,
        49.5,
        37.6
      ],
      [
        100.0,
        20.6,
        31.1,
        30.5,
        26.4,
        30.0,
        25.8,
        23.0,
        27.9,
        31.9,
        30.3,
        17.2,
        22.2
      ],
      [
        99.5,
        23.7,
        22.3,
        29.0,
        24.5,
        19.9,
        19.1,
        28.5,
        25.3,
        27.4,
        11.4,
        12.5,
        15.2
      ],
      [
        100.0,
        19.0,
        23.0,
        24.2,
        23.3,
        20.3,
        24.6,
        30.2,
        27.5,
        10.8,
        11.5,
        14.2,
        20.1
      ],
      [
        100.0,
        19.4,
        19.4,
        16.3,
        18.4,
        22.4,
        27.6,
        26.2,
        10.5,
        10.9,
        7.5,
        13.9,
        13.9
      ],
      [
        100.0,
        15.7,
        16.9,
        17.3,
        17.7,
        25.6,
        21.3,
        12.6,
        5.9,
        8.3,
        11.4,
        13.4,
        15.4
      ],
      [
        100.0,
        17.4,
        18.9,
        20.4,
        23.0,
        28.5,
        12.6,
        8.9,
        8.1,
        11.9,
        10.7,
        13.7,
        14.8
      ],
      [
        100.0,
        15.6,
        18.3,
        29.6,
        29.0,
        14.0,
        11.3,
        14.5,
        14.5,
        11.3,
        13.4,
        14.5,
        13.4
      ],
      [
        100.0,
        20.4,
        29.6,
        32.1,
        17.3,
        11.7,
        9.9,
        12.3,
        13.6,
        13.0,
        13.0,
        12.3,
        15.4
      ],
      [
        100.0,
        22.6,
        23.5,
        12.3,
        9.1,
        10.3,
        13.6,
        9.9,
        12.8,
        13.2,
        11.5,
        9.9,
        21.8
      ],
      [
        100.0,
        25.7,
        14.6,
        12.5,
        8.8,
        8.2,
        13.0,
        13.8,
        10.6,
        9.3,
        10.6,
        13.0,
        19.1
      ],
      [
        100.0,
        17.5,
        9.2,
        9.5,
        7.7,
        8.6,
        12.9,
        9.8,
        8.6,
        8.9,
        11.1,
        14.5,
        25.5
      ],
      [
        100.0,
        9.2,
        5.3,
        9.2,
        11.8,
        6.6,
        5.3,
        9.2,
        5.3,
        2.6,
        9.2,
        19.7,
        2.6
      ],
      [
        100.0,
        16.9,
        21.1,
        19.7,
        21.1,
        15.5,
        15.5,
        12.7,
        11.3,
        21.1,
        25.4,
        11.3,
        0.0
      ],
      [
        100.0,
        16.1,
        15.3,
        18.5,
        21.8,
        15.3,
        15.3,
        14.5,
        14.5,
        17.7,
        5.6,
        0.0,
        0.0
      ],
      [
        100.0,
        18.4,
        21.8,
        20.1,
        22.3,
        15.1,
        20.7,
        20.1,
        24.0,
        9.5,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        25.5,
        19.8,
        19.8,
        17.9,
        23.6,
        17.9,
        25.5,
        11.3,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        23.4,
        24.3,
        16.2,
        21.6,
        20.7,
        26.1,
        11.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        23.1,
        21.3,
        26.9,
        20.4,
        28.7,
        8.3,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        21.6,
        30.4,
        27.5,
        34.3,
        15.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        27.4,
        31.1,
        26.4,
        17.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        27.0,
        37.6,
        14.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        32.1,
        15.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        99.5,
        14.1,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    ]
  },
  "revenue_matrix": {
    "cohorts": [
      "2009-12",
      "2010-01",
      "2010-02",
      "2010-03",
      "2010-04",
      "2010-05",
      "2010-06",
      "2010-07",
      "2010-08",
      "2010-09",
      "2010-10",
      "2010-11",
      "2010-12",
      "2011-01",
      "2011-02",
      "2011-03",
      "2011-04",
      "2011-05",
      "2011-06",
      "2011-07",
      "2011-08",
      "2011-09",
      "2011-10",
      "2011-11",
      "2011-12"
    ],
    "offsets": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "values": [
      [
        100.0,
        57.6,
        43.2,
        55.3,
        44.7,
        44.6,
        44.1,
        45.7,
        48.4,
        57.2,
        67.2,
        83.5,
        77.1
      ],
      [
        100.0,
        24.2,
        31.6,
        35.7,
        36.4,
        37.8,
        32.2,
        29.8,
        37.4,
        46.2,
        47.6,
        38.3,
        26.4
      ],
      [
        100.0,
        19.6,
        32.2,
        31.3,
        25.8,
        23.3,
        23.6,
        30.1,
        31.1,
        32.2,
        21.6,
        11.3,
        16.3
      ],
      [
        100.0,
        21.2,
        22.1,
        27.5,
        21.4,
        23.8,
        27.9,
        34.7,
        32.6,
        15.0,
        10.5,
        12.8,
        18.6
      ],
      [
        100.0,
        15.2,
        16.6,
        24.1,
        17.8,
        24.7,
        28.2,
        26.2,
        12.3,
        14.1,
        5.2,
        13.6,
        17.1
      ],
      [
        100.0,
        12.3,
        12.8,
        11.6,
        15.2,
        28.3,
        21.1,
        12.4,
        5.3,
        6.5,
        8.4,
        11.9,
        15.7
      ],
      [
        100.0,
        12.2,
        17.1,
        19.6,
        26.6,
        36.8,
        19.3,
        13.1,
        18.1,
        21.6,
        9.5,
        22.7,
        30.6
      ],
      [
        100.0,
        11.1,
        18.3,
        33.2,
        38.4,
        21.0,
        12.1,
        14.0,
        13.8,
        13.3,
        12.2,
        16.8,
        16.3
      ],
      [
        100.0,
        22.6,
        37.9,
        38.5,
        36.6,
        8.9,
        8.7,
        11.9,
        16.1,
        16.1,
        11.9,
        11.5,
        18.4
      ],
      [
        100.0,
        18.6,
        20.2,
        13.5,
        16.4,
        5.2,
        16.3,
        6.8,
        18.4,
        9.2,
        12.5,
        16.3,
        64.3
      ],
      [
        100.0,
        25.2,
        15.7,
        13.1,
        7.0,
        6.1,
        9.5,
        8.7,
        12.0,
        10.5,
        7.4,
        11.4,
        26.9
      ],
      [
        100.0,
        24.0,
        9.3,
        6.3,
        6.3,
        6.9,
        10.2,
        7.3,
        6.3,
        7.2,
        9.6,
        12.9,
        26.3
      ],
      [
        100.0,
        5.8,
        17.3,
        3.6,
        15.2,
        2.6,
        1.8,
        12.0,
        1.5,
        1.2,
        4.0,
        21.5,
        1.2
      ],
      [
        100.0,
        7.4,
        7.8,
        51.9,
        15.8,
        12.6,
        10.0,
        10.9,
        8.8,
        22.4,
        20.6,
        7.1,
        0.0
      ],
      [
        100.0,
        19.4,
        37.4,
        24.3,
        21.1,
        12.7,
        18.2,
        23.0,
        21.7,
        28.1,
        6.4,
        0.0,
        0.0
      ],
      [
        100.0,
        20.0,
        26.2,
        21.5,
        21.3,
        13.9,
        20.0,
        24.0,
        28.1,
        8.2,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        32.5,
        18.8,
        17.6,
        14.1,
        27.2,
        15.0,
        27.8,
        9.5,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        17.8,
        19.8,
        12.3,
        20.1,
        20.0,
        27.1,
        100.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        12.2,
        9.4,
        13.0,
        11.7,
        17.5,
        2.9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        17.4,
        26.2,
        27.9,
        34.2,
        10.3,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        41.5,
        69.7,
        88.9,
        31.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        21.1,
        32.6,
        10.6,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        31.1,
        10.2,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        15.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    ]
  },
  "segments": [
    {
      "segment": "Champions",
      "customers": 1413,
      "repeaters": 1413,
      "orders": 22931,
      "revenue": 12213559.47,
      "aov": 532.62,
      "repeat_rate": 100.0
    },
    {
      "segment": "Loyal",
      "customers": 680,
      "repeaters": 680,
      "orders": 6015,
      "revenue": 2464064.12,
      "aov": 409.65,
      "repeat_rate": 100.0
    },
    {
      "segment": "Potential Loyalist",
      "customers": 712,
      "repeaters": 712,
      "orders": 2055,
      "revenue": 879412.22,
      "aov": 427.94,
      "repeat_rate": 100.0
    },
    {
      "segment": "At Risk",
      "customers": 492,
      "repeaters": 492,
      "orders": 2023,
      "revenue": 759944.75,
      "aov": 375.65,
      "repeat_rate": 100.0
    },
    {
      "segment": "Need Attention",
      "customers": 456,
      "repeaters": 456,
      "orders": 1321,
      "revenue": 506982.37,
      "aov": 383.79,
      "repeat_rate": 100.0
    },
    {
      "segment": "Lost",
      "customers": 941,
      "repeaters": 232,
      "orders": 1173,
      "revenue": 414713.34,
      "aov": 353.55,
      "repeat_rate": 24.7
    },
    {
      "segment": "About To Sleep",
      "customers": 701,
      "repeaters": 270,
      "orders": 971,
      "revenue": 323398.59,
      "aov": 333.06,
      "repeat_rate": 38.5
    },
    {
      "segment": "Others",
      "customers": 246,
      "repeaters": 0,
      "orders": 246,
      "revenue": 100116.46,
      "aov": 406.98,
      "repeat_rate": 0.0
    },
    {
      "segment": "Promising",
      "customers": 164,
      "repeaters": 0,
      "orders": 164,
      "revenue": 55038.55,
      "aov": 335.6,
      "repeat_rate": 0.0
    },
    {
      "segment": "New Customers",
      "customers": 76,
      "repeaters": 0,
      "orders": 76,
      "revenue": 26199.31,
      "aov": 344.73,
      "repeat_rate": 0.0
    }
  ],
  "segment_bars": [
    {
      "label": "Champions",
      "value": 12213559.47
    },
    {
      "label": "Loyal",
      "value": 2464064.12
    },
    {
      "label": "Potential Loyalist",
      "value": 879412.22
    },
    {
      "label": "At Risk",
      "value": 759944.75
    },
    {
      "label": "Need Attention",
      "value": 506982.37
    },
    {
      "label": "Lost",
      "value": 414713.34
    },
    {
      "label": "About To Sleep",
      "value": 323398.59
    },
    {
      "label": "Others",
      "value": 100116.46
    },
    {
      "label": "Promising",
      "value": 55038.55
    },
    {
      "label": "New Customers",
      "value": 26199.31
    }
  ]
}