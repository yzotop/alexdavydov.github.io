{
  "meta": {
    "dataset": "Online Retail II (UCI)",
    "generated_at": "2026-01-30T05:27:42Z",
    "variant": {
      "granularity": "month",
      "include_returns": false,
      "include_anon": true
    },
    "raw_rows": 1067371,
    "rows_after_filters": 1044420,
    "date_min": "2009-12-01",
    "date_max": "2011-12-09",
    "max_offsets": 12,
    "definitions": {
      "returns": "Invoice startswith 'C' OR Quantity < 0 treated as returns/cancellations",
      "retention": "share of cohort customers with >=1 order in offset period (with positive net revenue)"
    }
  },
  "sanity": {
    "checks": [
      {
        "key": "total_rows",
        "label": "Total rows",
        "value": "1,067,371",
        "ok": true
      },
      {
        "key": "rows_after_filters",
        "label": "Rows after filters",
        "value": "1,044,420",
        "ok": true
      },
      {
        "key": "missing_customerid",
        "label": "Missing CustomerID",
        "value": "243,007 (22.77%)",
        "ok": true
      },
      {
        "key": "qty_le_0",
        "label": "Quantity ≤ 0",
        "value": "22,950 (2.15%)",
        "ok": true
      },
      {
        "key": "unitprice_le_0",
        "label": "UnitPrice ≤ 0",
        "value": "6,207 (0.58%)",
        "ok": true
      },
      {
        "key": "cancellations",
        "label": "Cancellations (Invoice starts with C)",
        "value": "19,494 (1.83%)",
        "ok": true
      },
      {
        "key": "duplicates",
        "label": "Duplicate rows (row key)",
        "value": "34,339 (3.22%)",
        "ok": true
      },
      {
        "key": "date_range",
        "label": "InvoiceDate range",
        "value": "2009-12-01 → 2011-12-09",
        "ok": true
      },
      {
        "key": "top_countries",
        "label": "Top 5 countries by revenue (net)",
        "value": "United Kingdom (17,712,301.64), EIRE (664,431.78), Netherlands (554,232.34), Germany (431,262.46), France (356,944.60)",
        "ok": true
      },
      {
        "key": "p99_invoice_value",
        "label": "p99 invoice value (positive invoices)",
        "value": "4,542.06",
        "ok": true
      }
    ],
    "top_countries": [
      {
        "country": "United Kingdom",
        "revenue": 17712301.64
      },
      {
        "country": "EIRE",
        "revenue": 664431.78
      },
      {
        "country": "Netherlands",
        "revenue": 554232.34
      },
      {
        "country": "Germany",
        "revenue": 431262.46
      },
      {
        "country": "France",
        "revenue": 356944.6
      }
    ]
  },
  "cohort_matrix": {
    "cohorts": [
      "2009-12",
      "2010-01",
      "2010-02",
      "2010-03",
      "2010-04",
      "2010-05",
      "2010-06",
      "2010-07",
      "2010-08",
      "2010-09",
      "2010-10",
      "2010-11",
      "2010-12",
      "2011-01",
      "2011-02",
      "2011-03",
      "2011-04",
      "2011-05",
      "2011-06",
      "2011-07",
      "2011-08",
      "2011-09",
      "2011-10",
      "2011-11",
      "2011-12"
    ],
    "offsets": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "values": [
      [
        87.8,
        26.3,
        24.9,
        31.7,
        28.3,
        26.8,
        28.1,
        25.5,
        25.0,
        27.0,
        31.4,
        36.9,
        28.0
      ],
      [
        82.7,
        13.7,
        20.6,
        20.3,
        17.5,
        19.9,
        17.2,
        15.3,
        18.5,
        21.1,
        20.1,
        11.4,
        14.7
      ],
      [
        85.5,
        16.2,
        15.2,
        19.8,
        16.7,
        13.6,
        13.1,
        19.4,
        17.2,
        18.7,
        7.8,
        8.5,
        10.3
      ],
      [
        87.1,
        12.2,
        14.8,
        15.5,
        14.9,
        13.1,
        15.8,
        19.4,
        17.7,
        7.0,
        7.4,
        9.1,
        12.9
      ],
      [
        89.3,
        11.9,
        11.9,
        10.0,
        11.3,
        13.8,
        16.9,
        16.1,
        6.5,
        6.7,
        4.6,
        8.6,
        8.6
      ],
      [
        72.6,
        7.7,
        8.3,
        8.5,
        8.7,
        12.5,
        10.4,
        6.2,
        2.9,
        4.0,
        5.6,
        6.6,
        7.5
      ],
      [
        85.0,
        9.6,
        10.4,
        11.2,
        12.6,
        15.7,
        6.9,
        4.9,
        4.5,
        6.5,
        5.9,
        7.5,
        8.1
      ],
      [
        85.6,
        7.4,
        8.7,
        14.1,
        13.8,
        6.7,
        5.4,
        6.9,
        6.9,
        5.4,
        6.4,
        6.9,
        6.4
      ],
      [
        77.4,
        8.7,
        12.6,
        13.7,
        7.4,
        5.0,
        4.2,
        5.3,
        5.8,
        5.5,
        5.5,
        5.3,
        6.6
      ],
      [
        84.5,
        11.8,
        12.3,
        6.5,
        4.7,
        5.4,
        7.1,
        5.2,
        6.7,
        6.9,
        6.0,
        5.2,
        11.4
      ],
      [
        88.6,
        15.8,
        8.9,
        7.6,
        5.4,
        5.0,
        8.0,
        8.5,
        6.5,
        5.7,
        6.5,
        8.0,
        11.7
      ],
      [
        80.0,
        9.4,
        5.0,
        5.1,
        4.1,
        4.6,
        6.9,
        5.3,
        4.6,
        4.8,
        5.9,
        7.8,
        13.7
      ],
      [
        77.0,
        2.3,
        1.3,
        2.3,
        3.0,
        1.6,
        1.3,
        2.3,
        1.3,
        0.7,
        2.3,
        4.9,
        0.7
      ],
      [
        83.3,
        5.9,
        7.4,
        6.9,
        7.4,
        5.4,
        5.4,
        4.4,
        3.9,
        7.4,
        8.8,
        3.9,
        0.0
      ],
      [
        90.1,
        7.9,
        7.5,
        9.1,
        10.7,
        7.5,
        7.5,
        7.1,
        7.1,
        8.7,
        2.8,
        0.0,
        0.0
      ],
      [
        80.2,
        8.5,
        10.0,
        9.3,
        10.3,
        6.9,
        9.5,
        9.3,
        11.1,
        4.4,
        0.0,
        0.0,
        0.0
      ],
      [
        73.8,
        9.8,
        7.6,
        7.6,
        6.9,
        9.1,
        6.9,
        9.8,
        4.4,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        82.6,
        9.1,
        9.4,
        6.3,
        8.4,
        8.0,
        10.1,
        4.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        85.2,
        8.6,
        7.9,
        10.0,
        7.6,
        10.7,
        3.1,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        79.1,
        7.1,
        10.0,
        9.0,
        11.3,
        5.1,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        79.9,
        12.4,
        14.1,
        12.0,
        7.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        82.4,
        15.5,
        21.6,
        8.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        78.9,
        16.9,
        8.3,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        72.5,
        6.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        77.5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    ]
  },
  "revenue_matrix": {
    "cohorts": [
      "2009-12",
      "2010-01",
      "2010-02",
      "2010-03",
      "2010-04",
      "2010-05",
      "2010-06",
      "2010-07",
      "2010-08",
      "2010-09",
      "2010-10",
      "2010-11",
      "2010-12",
      "2011-01",
      "2011-02",
      "2011-03",
      "2011-04",
      "2011-05",
      "2011-06",
      "2011-07",
      "2011-08",
      "2011-09",
      "2011-10",
      "2011-11",
      "2011-12"
    ],
    "offsets": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "values": [
      [
        100.0,
        47.9,
        35.9,
        46.0,
        37.2,
        37.1,
        36.7,
        38.0,
        40.3,
        47.6,
        55.9,
        69.4,
        64.2
      ],
      [
        100.0,
        15.2,
        19.9,
        22.4,
        22.9,
        23.8,
        20.3,
        18.7,
        23.6,
        29.1,
        29.9,
        24.1,
        16.6
      ],
      [
        100.0,
        15.3,
        25.2,
        24.6,
        20.3,
        18.3,
        18.5,
        23.6,
        24.4,
        25.3,
        16.9,
        8.8,
        12.8
      ],
      [
        100.0,
        13.5,
        14.1,
        17.5,
        13.7,
        15.2,
        17.8,
        22.1,
        20.8,
        9.5,
        6.7,
        8.2,
        11.8
      ],
      [
        74.7,
        9.0,
        9.8,
        14.2,
        10.5,
        14.5,
        16.6,
        15.5,
        7.2,
        8.3,
        3.1,
        8.0,
        10.1
      ],
      [
        100.0,
        8.0,
        8.3,
        7.5,
        9.9,
        18.4,
        13.7,
        8.1,
        3.4,
        4.2,
        5.4,
        7.7,
        10.2
      ],
      [
        100.0,
        6.6,
        9.2,
        10.6,
        14.3,
        19.8,
        10.4,
        7.1,
        9.7,
        11.6,
        5.1,
        12.2,
        16.5
      ],
      [
        67.3,
        6.2,
        10.3,
        18.6,
        21.5,
        11.8,
        6.8,
        7.8,
        7.8,
        7.4,
        6.8,
        9.4,
        9.2
      ],
      [
        100.0,
        9.0,
        15.0,
        15.3,
        14.5,
        3.5,
        3.4,
        4.7,
        6.4,
        6.4,
        4.7,
        4.5,
        7.3
      ],
      [
        100.0,
        11.8,
        12.8,
        8.5,
        10.4,
        3.3,
        10.3,
        4.3,
        11.7,
        5.8,
        7.9,
        10.3,
        40.7
      ],
      [
        87.6,
        14.9,
        9.3,
        7.7,
        4.1,
        3.6,
        5.6,
        5.1,
        7.1,
        6.2,
        4.4,
        6.7,
        15.9
      ],
      [
        100.0,
        8.2,
        3.2,
        2.1,
        2.2,
        2.4,
        3.5,
        2.5,
        2.1,
        2.5,
        3.3,
        4.4,
        8.9
      ],
      [
        100.0,
        0.6,
        1.7,
        0.3,
        1.5,
        0.3,
        0.2,
        1.2,
        0.1,
        0.1,
        0.4,
        2.1,
        0.1
      ],
      [
        100.0,
        2.2,
        2.3,
        15.3,
        4.7,
        3.7,
        3.0,
        3.2,
        2.6,
        6.6,
        6.1,
        2.1,
        0.0
      ],
      [
        100.0,
        7.1,
        13.6,
        8.8,
        7.7,
        4.6,
        6.6,
        8.4,
        7.9,
        10.2,
        2.3,
        0.0,
        0.0
      ],
      [
        100.0,
        7.8,
        10.2,
        8.4,
        8.3,
        5.4,
        7.8,
        9.4,
        11.0,
        3.2,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        12.2,
        7.0,
        6.6,
        5.3,
        10.2,
        5.6,
        10.4,
        3.6,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        6.5,
        7.2,
        4.5,
        7.3,
        7.3,
        9.9,
        100.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        5.6,
        4.3,
        5.9,
        5.3,
        8.0,
        1.3,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        4.7,
        7.1,
        7.5,
        9.2,
        2.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        86.1,
        11.8,
        19.8,
        25.2,
        8.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        10.1,
        15.5,
        5.1,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        15.0,
        4.9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        3.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        100.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    ]
  },
  "segments": [
    {
      "segment": "Champions",
      "customers": 2928,
      "repeaters": 2928,
      "orders": 29914,
      "revenue": 15055721.26,
      "aov": 503.3,
      "repeat_rate": 100.0
    },
    {
      "segment": "Loyal",
      "customers": 1174,
      "repeaters": 1174,
      "orders": 4971,
      "revenue": 1892659.73,
      "aov": 380.74,
      "repeat_rate": 100.0
    },
    {
      "segment": "Others",
      "customers": 1517,
      "repeaters": 0,
      "orders": 1517,
      "revenue": 1046516.81,
      "aov": 689.86,
      "repeat_rate": 0.0
    },
    {
      "segment": "About To Sleep",
      "customers": 1667,
      "repeaters": 0,
      "orders": 1667,
      "revenue": 766620.19,
      "aov": 459.88,
      "repeat_rate": 0.0
    },
    {
      "segment": "Lost",
      "customers": 1988,
      "repeaters": 0,
      "orders": 1988,
      "revenue": 741079.63,
      "aov": 372.78,
      "repeat_rate": 0.0
    },
    {
      "segment": "Promising",
      "customers": 976,
      "repeaters": 0,
      "orders": 976,
      "revenue": 562388.28,
      "aov": 576.22,
      "repeat_rate": 0.0
    },
    {
      "segment": "New Customers",
      "customers": 446,
      "repeaters": 0,
      "orders": 446,
      "revenue": 522058.17,
      "aov": 1170.53,
      "repeat_rate": 0.0
    },
    {
      "segment": "At Risk",
      "customers": 153,
      "repeaters": 153,
      "orders": 464,
      "revenue": 226874.35,
      "aov": 488.95,
      "repeat_rate": 100.0
    }
  ],
  "segment_bars": [
    {
      "label": "Champions",
      "value": 15055721.26
    },
    {
      "label": "Loyal",
      "value": 1892659.73
    },
    {
      "label": "Others",
      "value": 1046516.81
    },
    {
      "label": "About To Sleep",
      "value": 766620.19
    },
    {
      "label": "Lost",
      "value": 741079.63
    },
    {
      "label": "Promising",
      "value": 562388.28
    },
    {
      "label": "New Customers",
      "value": 522058.17
    },
    {
      "label": "At Risk",
      "value": 226874.35
    }
  ]
}