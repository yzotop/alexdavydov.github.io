{
  "meta": {
    "dataset": "Online Retail II (UCI)",
    "generated_at": "2026-01-30T05:27:42Z",
    "variant": {
      "granularity": "month",
      "include_returns": true,
      "include_anon": true
    },
    "raw_rows": 1067371,
    "rows_after_filters": 1067371,
    "date_min": "2009-12-01",
    "date_max": "2011-12-09",
    "max_offsets": 12,
    "definitions": {
      "returns": "Invoice startswith 'C' OR Quantity < 0 treated as returns/cancellations",
      "retention": "share of cohort customers with >=1 order in offset period (with positive net revenue)"
    }
  },
  "sanity": {
    "checks": [
      {
        "key": "total_rows",
        "label": "Total rows",
        "value": "1,067,371",
        "ok": true
      },
      {
        "key": "rows_after_filters",
        "label": "Rows after filters",
        "value": "1,067,371",
        "ok": true
      },
      {
        "key": "missing_customerid",
        "label": "Missing CustomerID",
        "value": "243,007 (22.77%)",
        "ok": true
      },
      {
        "key": "qty_le_0",
        "label": "Quantity ≤ 0",
        "value": "22,950 (2.15%)",
        "ok": true
      },
      {
        "key": "unitprice_le_0",
        "label": "UnitPrice ≤ 0",
        "value": "6,207 (0.58%)",
        "ok": true
      },
      {
        "key": "cancellations",
        "label": "Cancellations (Invoice starts with C)",
        "value": "19,494 (1.83%)",
        "ok": true
      },
      {
        "key": "duplicates",
        "label": "Duplicate rows (row key)",
        "value": "34,339 (3.22%)",
        "ok": true
      },
      {
        "key": "date_range",
        "label": "InvoiceDate range",
        "value": "2009-12-01 → 2011-12-09",
        "ok": true
      },
      {
        "key": "top_countries",
        "label": "Top 5 countries by revenue (net)",
        "value": "United Kingdom (16,382,583.90), EIRE (615,519.55), Netherlands (548,524.95), Germany (417,988.56), France (328,191.80)",
        "ok": true
      },
      {
        "key": "p99_invoice_value",
        "label": "p99 invoice value (positive invoices)",
        "value": "4,541.85",
        "ok": true
      }
    ],
    "top_countries": [
      {
        "country": "United Kingdom",
        "revenue": 16382583.9
      },
      {
        "country": "EIRE",
        "revenue": 615519.55
      },
      {
        "country": "Netherlands",
        "revenue": 548524.95
      },
      {
        "country": "Germany",
        "revenue": 417988.56
      },
      {
        "country": "France",
        "revenue": 328191.8
      }
    ]
  },
  "cohort_matrix": {
    "cohorts": [
      "2009-12",
      "2010-01",
      "2010-02",
      "2010-03",
      "2010-04",
      "2010-05",
      "2010-06",
      "2010-07",
      "2010-08",
      "2010-09",
      "2010-10",
      "2010-11",
      "2010-12",
      "2011-01",
      "2011-02",
      "2011-03",
      "2011-04",
      "2011-05",
      "2011-06",
      "2011-07",
      "2011-08",
      "2011-09",
      "2011-10",
      "2011-11",
      "2011-12"
    ],
    "offsets": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "values": [
      [
        80.2,
        23.9,
        22.6,
        28.9,
        25.8,
        24.4,
        25.7,
        23.4,
        22.9,
        24.6,
        28.6,
        33.6,
        25.7
      ],
      [
        65.2,
        10.5,
        16.1,
        15.8,
        13.9,
        15.5,
        13.3,
        12.2,
        14.7,
        16.9,
        15.6,
        8.8,
        11.6
      ],
      [
        46.7,
        8.8,
        8.4,
        10.7,
        9.0,
        7.2,
        7.1,
        10.6,
        9.4,
        10.3,
        4.4,
        4.6,
        5.6
      ],
      [
        65.4,
        9.1,
        11.1,
        11.6,
        11.1,
        9.7,
        11.6,
        14.8,
        13.5,
        5.3,
        5.5,
        7.0,
        9.5
      ],
      [
        73.7,
        9.4,
        9.9,
        8.1,
        9.2,
        11.6,
        14.0,
        12.8,
        5.5,
        5.4,
        3.8,
        7.1,
        6.9
      ],
      [
        41.5,
        4.3,
        4.6,
        5.0,
        5.0,
        7.2,
        6.1,
        3.5,
        1.8,
        2.3,
        3.2,
        3.9,
        4.3
      ],
      [
        63.1,
        7.0,
        7.7,
        8.3,
        9.3,
        11.7,
        5.2,
        3.6,
        3.3,
        4.9,
        4.2,
        5.6,
        6.1
      ],
      [
        68.3,
        5.9,
        6.9,
        11.2,
        11.0,
        5.1,
        4.3,
        5.7,
        5.5,
        4.3,
        5.1,
        5.5,
        5.1
      ],
      [
        59.6,
        6.3,
        9.8,
        10.4,
        5.5,
        3.9,
        3.3,
        4.1,
        4.5,
        4.1,
        4.3,
        4.1,
        5.1
      ],
      [
        67.2,
        9.5,
        9.7,
        5.2,
        3.6,
        4.3,
        5.7,
        4.0,
        5.4,
        5.4,
        4.7,
        4.0,
        9.3
      ],
      [
        71.4,
        12.6,
        7.2,
        6.0,
        4.3,
        4.3,
        6.6,
        6.6,
        5.4,
        4.7,
        5.3,
        6.6,
        9.7
      ],
      [
        57.0,
        6.7,
        3.6,
        3.6,
        2.9,
        3.4,
        5.2,
        3.9,
        3.4,
        3.8,
        4.3,
        5.7,
        9.8
      ],
      [
        59.6,
        1.8,
        1.0,
        1.5,
        2.3,
        1.3,
        1.0,
        1.8,
        1.0,
        0.5,
        1.8,
        3.8,
        0.5
      ],
      [
        55.0,
        3.5,
        5.1,
        4.2,
        5.1,
        3.2,
        3.5,
        2.9,
        2.6,
        4.8,
        5.8,
        2.6,
        0.0
      ],
      [
        72.1,
        6.0,
        6.0,
        7.3,
        8.6,
        6.0,
        6.0,
        5.7,
        5.7,
        7.0,
        2.2,
        0.0,
        0.0
      ],
      [
        57.5,
        5.9,
        7.2,
        6.6,
        7.4,
        4.8,
        6.8,
        6.6,
        7.9,
        3.1,
        0.0,
        0.0,
        0.0
      ],
      [
        43.6,
        5.6,
        4.5,
        4.5,
        4.1,
        5.4,
        4.1,
        5.8,
        2.6,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        56.0,
        6.1,
        6.4,
        4.2,
        5.6,
        5.4,
        6.8,
        2.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        60.0,
        5.8,
        5.6,
        7.0,
        5.3,
        7.5,
        2.2,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        56.2,
        4.8,
        7.1,
        6.4,
        8.0,
        3.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        62.7,
        9.7,
        11.0,
        9.3,
        6.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        61.9,
        11.4,
        16.2,
        6.4,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        55.5,
        11.9,
        5.9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        53.3,
        4.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        55.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    ]
  },
  "revenue_matrix": {
    "cohorts": [
      "2009-12",
      "2010-01",
      "2010-02",
      "2010-03",
      "2010-04",
      "2010-05",
      "2010-06",
      "2010-07",
      "2010-08",
      "2010-09",
      "2010-10",
      "2010-11",
      "2010-12",
      "2011-01",
      "2011-02",
      "2011-03",
      "2011-04",
      "2011-05",
      "2011-06",
      "2011-07",
      "2011-08",
      "2011-09",
      "2011-10",
      "2011-11",
      "2011-12"
    ],
    "offsets": [
      0,
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "values": [
      [
        99.6,
        45.8,
        35.1,
        45.9,
        36.1,
        34.3,
        36.5,
        37.0,
        38.7,
        45.0,
        51.8,
        68.1,
        64.0
      ],
      [
        98.5,
        14.9,
        19.8,
        21.7,
        22.1,
        23.2,
        19.6,
        22.6,
        18.4,
        28.8,
        29.4,
        23.1,
        15.8
      ],
      [
        98.3,
        15.5,
        25.1,
        24.2,
        19.6,
        18.1,
        17.5,
        23.7,
        24.4,
        25.6,
        17.0,
        8.8,
        12.8
      ],
      [
        91.3,
        14.3,
        13.8,
        15.8,
        14.3,
        15.6,
        18.5,
        23.7,
        22.1,
        9.8,
        7.0,
        8.6,
        12.6
      ],
      [
        66.3,
        8.2,
        9.6,
        11.2,
        10.4,
        14.7,
        16.6,
        14.8,
        7.5,
        8.1,
        3.0,
        8.1,
        7.1
      ],
      [
        97.4,
        7.7,
        8.2,
        7.7,
        9.7,
        18.3,
        13.8,
        7.8,
        2.8,
        4.1,
        5.5,
        7.8,
        10.3
      ],
      [
        82.3,
        5.1,
        9.4,
        10.7,
        14.6,
        20.1,
        10.2,
        7.2,
        10.0,
        11.9,
        4.8,
        12.5,
        16.9
      ],
      [
        65.3,
        5.7,
        10.1,
        18.3,
        21.1,
        11.6,
        6.6,
        7.9,
        7.5,
        7.4,
        6.7,
        9.3,
        9.1
      ],
      [
        84.7,
        8.2,
        14.9,
        13.6,
        9.6,
        3.3,
        3.5,
        4.7,
        6.3,
        6.3,
        4.7,
        4.6,
        7.2
      ],
      [
        91.9,
        7.9,
        12.9,
        10.8,
        10.2,
        2.9,
        10.4,
        4.2,
        11.7,
        5.5,
        7.9,
        10.3,
        39.7
      ],
      [
        82.5,
        13.5,
        8.6,
        7.9,
        4.5,
        3.8,
        5.8,
        5.2,
        7.2,
        6.6,
        4.6,
        7.0,
        15.9
      ],
      [
        97.7,
        7.8,
        3.2,
        2.1,
        1.9,
        2.4,
        3.5,
        2.6,
        2.2,
        2.7,
        3.3,
        4.5,
        9.2
      ],
      [
        73.5,
        0.5,
        1.7,
        0.3,
        1.4,
        0.3,
        0.2,
        1.2,
        0.1,
        0.1,
        0.4,
        2.1,
        0.1
      ],
      [
        78.6,
        2.0,
        2.4,
        1.9,
        4.7,
        3.6,
        2.8,
        3.2,
        2.5,
        6.6,
        6.1,
        2.1,
        0.0
      ],
      [
        87.5,
        7.0,
        13.6,
        8.9,
        7.6,
        4.6,
        6.6,
        8.2,
        7.9,
        10.2,
        2.3,
        0.0,
        0.0
      ],
      [
        90.5,
        6.9,
        10.0,
        8.0,
        8.1,
        5.3,
        7.7,
        9.1,
        10.7,
        3.2,
        0.0,
        0.0,
        0.0
      ],
      [
        98.7,
        11.9,
        6.9,
        6.6,
        5.1,
        10.2,
        5.6,
        10.4,
        3.6,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        87.9,
        6.6,
        7.4,
        4.4,
        7.5,
        7.5,
        10.0,
        2.9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        88.0,
        6.6,
        5.4,
        7.1,
        6.4,
        9.2,
        1.7,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        92.3,
        4.6,
        7.0,
        7.4,
        9.2,
        2.8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        70.1,
        10.9,
        18.3,
        23.0,
        8.1,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        91.3,
        8.9,
        15.0,
        5.1,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        90.8,
        15.5,
        5.1,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        95.7,
        2.9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ],
      [
        79.6,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0
      ]
    ]
  },
  "segments": [
    {
      "segment": "Champions",
      "customers": 3246,
      "repeaters": 3246,
      "orders": 37944,
      "revenue": 14773255.05,
      "aov": 389.34,
      "repeat_rate": 100.0
    },
    {
      "segment": "Loyal",
      "customers": 1085,
      "repeaters": 1085,
      "orders": 5005,
      "revenue": 1368840.05,
      "aov": 273.49,
      "repeat_rate": 100.0
    },
    {
      "segment": "Others",
      "customers": 2305,
      "repeaters": 0,
      "orders": 2305,
      "revenue": 965657.43,
      "aov": 418.94,
      "repeat_rate": 0.0
    },
    {
      "segment": "Promising",
      "customers": 1778,
      "repeaters": 0,
      "orders": 1778,
      "revenue": 547852.34,
      "aov": 308.13,
      "repeat_rate": 0.0
    },
    {
      "segment": "New Customers",
      "customers": 870,
      "repeaters": 0,
      "orders": 870,
      "revenue": 543639.42,
      "aov": 624.87,
      "repeat_rate": 0.0
    },
    {
      "segment": "Lost",
      "customers": 2778,
      "repeaters": 0,
      "orders": 2778,
      "revenue": 515682.74,
      "aov": 185.63,
      "repeat_rate": 0.0
    },
    {
      "segment": "About To Sleep",
      "customers": 2482,
      "repeaters": 0,
      "orders": 2482,
      "revenue": 459775.05,
      "aov": 185.24,
      "repeat_rate": 0.0
    },
    {
      "segment": "At Risk",
      "customers": 150,
      "repeaters": 150,
      "orders": 466,
      "revenue": 112548.49,
      "aov": 241.52,
      "repeat_rate": 100.0
    }
  ],
  "segment_bars": [
    {
      "label": "Champions",
      "value": 14773255.05
    },
    {
      "label": "Loyal",
      "value": 1368840.05
    },
    {
      "label": "Others",
      "value": 965657.43
    },
    {
      "label": "Promising",
      "value": 547852.34
    },
    {
      "label": "New Customers",
      "value": 543639.42
    },
    {
      "label": "Lost",
      "value": 515682.74
    },
    {
      "label": "About To Sleep",
      "value": 459775.05
    },
    {
      "label": "At Risk",
      "value": 112548.49
    }
  ]
}